.. _physics_glossary:

Physics Glossary
==================

.. glossary::
  :sorted:

  Q
    Fusion power thermal gain factor.

  P_fusion
    Total power generated by fusion integrated over the plasma volume. For DT fusion, this is the sum of the power going to the alpha particles and to the neutrons.

  P_neutron
    Fusion power released as neutrons integrated over the plasma volume.

  P_alpha
    Fusion power released as alpha particles integrated over the plasma volume.

  P_external
    External heating absorbed by the plasma (ohmic plus auxillary) integrated over the plasma volume.
  
  P_launched
    External heating supplied to the plasma (entering the volume, but not necessarily absorbed â€” ohmic plus auxillary) integrated over the plasma volume.

  fraction_of_external_power_coupled
    Fraction of supplied external heating absorbed by the plasma: :math:`f_{coupled}=P_{external} / P_{launched}`.

  P_radiation
    Power radiated from the confined region due to Bremmsstrahlung, synchrotron and impurity excitation-relaxation processes.

  P_radiated_by_core_radiator
    Power radiated from the confined region due to the injection of an :term:`extrinsic<extrinsic impurity>` core radiator.

  extrinsic impurity
    An impurity which has intentionally been injected into the plasma to enhance radiative power dissipation.

  intrinsic impurity
    An impurity which is assumed to be already in the plasma (without being injected by us).

  P_SOL
  power_crossing_separatrix
    Power crossing the separatrix and entering the scrape-off-layer.
  
  SOL_power_loss_fraction
    Fraction of power entering a scrape-off-layer flux tube which is lost (radiated or cross-field transported) before reaching the divertor target.

  SOL_momentum_loss_function
    Fraction of momentum entering a scrape-off-layer flux tube which is lost before reaching the divertor target.

  kappa_e0
    Electron heat conductivity constant, such that :math:`q_{e,\parallel,cond}=\kappa_{e0}T_{e}^{5/2}\nabla_\parallel T_e`.

  toroidal_flux_expansion
    Ratio of the divertor target major radius to the :term:`upstream` major radius for the two point model :math:`R_{target} / R_{upstream}`.

  nesep_over_nebar
    Ratio of the separatrix electron density to the volume-averaged electron density :math:`n_{e,sep} / \bar n_e`.

  parallel_connection_length
    Length along a field-line from :term:`upstream` to the divertor target.
  
  upstream
    The point where heat enters the flux-tube being considered for the two-point-model. Usually 'upstream' means the outboard-midplane separatrix.

  separatrix_electron_temp
    The :term:`upstream` electron temperature.
  
  separatrix_electron_density
    The :term:`upstream` electron density.

  target_electron_density
    The :term:`target` electron density.

  target
    The divertor target. Although there are several divertor targets, we usually perform the two-point-model analysis for the low-field-side (outboard) divertor target.

  target_electron_temp
    The :term:`target` electron temperature.

  target_electron_flux
    The rate of electrons per unit area reaching the :term:`target`.

  target_q_parallel
    The parallel heat flux density at the :term:`target`.

  neutron_power_flux_to_walls
    Neutron power per unit area to the wall.

  neutron_rate
    Number of neutrons produced per second.

  B_t_out_mid
    Toroidal magnetic field at outboard midplane separatrix

  B_pol_omp
  B_pol_out_mid
    Poloidal magnetic field at outboard midplane separatrix

  fieldline_pitch_at_omp
    The :term:`upstream` pitch of the magnetic field :math:`B_{tot} / B_{pol}`, used to convert from poloidal to parallel heat flux density.

  lambda_q_scaling
    A :class:`~cfspopcon.named_options.LambdaQScaling` indicating which scaling to use for :term:`lambda_q`.

  lambda_q
    The :term:`upstream` parallel heat flux density (:math:`q_\parallel`) near-SOL cross-field decay length.

  lambda_q_factor
    A scaling factor :math:`C` which can be used to increase or decrease :math:`\lambda_q=C \lambda_{q,scaling}`.

  q_perp
    The :term:`upstream` poloidal heat flux density.

  q_parallel
    The :term:`upstream` parallel heat flux density.

  PBpRnSq
    :math:`P_{SOL}B_{pol}/(R n_{sep}^2)`, a metric used to estimate how challenging heat exhaust will be. This metric is approximately :math:`q_\parallel/n_{e,sep}^2`, which in the Lengyel model gives the impurity concentration required for detachment.

  PB_over_R
    :math:`P_{SOL}B_0/R`, a metric used to estimate how challenging heat exhaust will be.

  atomic_data
    Dictionary mapping :class:`~cfspopcon.named_options.AtomicSpecies` to datasets giving coronal and non-coronal :math:`L_z` radiated power factors and :math:`\langle Z \rangle` mean charge state curves from `radas <https://github.com/cfs-energy/radas>`_.

  impurities
    A :class:`xarray.DataArray` giving the concentration of non-fuel species relative to the electron density.
    This array must have a dimension `dim_species` with :class:`~cfspopcon.named_options.AtomicSpecies` coordinates.
    There are several functions in the :mod:`cfspopcon.helpers` module to help you make and extend the `impurities` array.

  impurity_species
    An :class:`~cfspopcon.named_options.AtomicSpecies` indicating which non-fuel atomic species we are performing a calculation for.

  impurity_concentration
    Concentration of a non-fuel atomic species relative to the electron density :math:`c_Z = n_Z / n_e`.

  impurity_charge_state
    The mean charge state of a non-fuel species.

  greenwald_fraction
    Ratio of the average electron density to the Greenwald density limit :math:`f_{G}=\bar n_e / n_G`.

  tau_i
    AtomicSpecies residence/recycling time, which leads to a non-coronal enhancement of radiated power.

  radiated_power_method
    A :class:`~cfspopcon.named_options.RadiationMethod` indicating how we should calculate the power radiated from the confined region.

  dilution
    Fuel-species concentration as a fraction of the electron density :math:`n_{DT}/n_e`.

  core_radiator
    An :class:`~cfspopcon.named_options.AtomicSpecies` indicating which :term:`extrinsic<extrinsic impurity>` core radiator species should be injected into the confined region to enhance the core radiated power.

  core_radiator_charge_state
    Charge state of the :term:`extrinsic<extrinsic impurity>` core radiator.

  core_radiator_concentration
    Concentration of the :term:`extrinsic<extrinsic impurity>` core radiator required to achieve the desired core radiated power fraction, relative to the electron density :math:`c_{core} = n_{core}/n_e`.

  mean_ion_charge_state
    Mean charge state of the ions (:math:`n_e / \sum_j n_j`)
  
  ion_to_electron_temp_ratio
    Ratio of electron and ion temperatures, :math:`T_i/T_e`.

  electron_density_profile
    A 1D profile of the electron density as a function of :math:`\rho_{pol}`.

  electron_temp_profile
    A 1D profile of the electron temperature as a function of :math:`\rho_{pol}`.

  ion_temp_profile
    A 1D profile of the ion temperature as a function of :math:`\rho_{pol}`.

  profile_form
    A :class:`~cfspopcon.named_options.ProfileForm` indicating which sort of assumed profile shape we should use.

  z_effective
    The "effective charge" of the ions, defined as :math:`\sum_j Z_j^2 n_j / n_e`.

  rho
    The square-root of the normalized poloidal flux :math:`\rho_{pol}=\sqrt{\psi_N}`, used as a flux surface label.

  plasma_volume
    Plasma volume inside the last-closed-flux-surface.

  normalized_inverse_temp_scale_length
    Inverse normalized electron temperature gradient scale length :math:`a / ( T_e / \nabla T_e )`, which defines the shape of the :class:`~cfspopcon.named_options.ProfileForm.prf` profiles.

  inverse_aspect_ratio
    Ratio of minor to major radius :math:`\epsilon= a / R_0`.

  confinement_time_scalar
    Usually denoted :math:`H`, scalar applied to the energy confinement time calculated from a scaling such that :math:`\tau_e = H \tau_{e,scaling}`.

  plasma_current
    Current carried by the plasma :math:`I_p`.

  magnetic_field_on_axis
    Magnetic field at the geometric magnetic axis :math:`B_0 = BR / R0`.

  average_electron_density
    Volume-averaged electron density in the confined region :math:`\bar n_e`.

  average_electron_temp
    Volume-averaged electron temperature in the confined region :math:`\bar T_e`.

  summed_impurity_density
    Density of non-fuel ions.

  average_ion_density
    Volume-averaged ion density in the confined region :math:`\bar n_i`.

  average_ion_temp
    Volume-averaged ion temperature in the confined region :math:`\bar T_i`.

  average_total_pressure
    Sum of electron and ion pressures.

  areal_elongation
    Elongation of the confined region computed using the poloidal area inside the last-closed-flux-surface :math:`\kappa_A = S_{pol} / (\pi a^2)`.

  beta
  beta_toroidal
    Ratio of plasma pressure to magnetic pressure provided by the toroidal magnetic field.

  beta_poloidal
    Ratio of plasma pressure to magnetic pressure provided by the poloidal magnetic field.

  beta_total
    Ratio of plasma pressure to magnetic pressure provided by the total magnetic field.

  normalized_beta
  beta_N
    Ratio of plasma pressure to magnetic pressure provided by the total magnetic field, normalized to :math:`I_MA / a B_0`.

  separatrix_elongation
    Elongation of the last-closed-flux-surface :math:`(Z_{max,LCFS} - Z_{min,LCFS}) / (R_{max,LCFS} - R_{min,LCFS})`.

  elongation_ratio_sep_to_areal
    Ratio of separatrix elongation to areal elongation :math:`\kappa_{sep}/\kappa_A`.

  triangularity_ratio_sep_to_psi95
    Ratio of separatrix triangularity to triangularity at the :math:`psi_N=0.95` surface :math:`\delta_{sep}/\delta_{95}.`

  f_shaping
    Shaping factor used to compute :math:`q_*`.

  ion_mass
  fuel_average_mass_number
    Average mass of fuel ions, with the average weighted by the relative concentration of each species.

  surface_area
    Area of the last-closed-flux-surface, i.e. the surface defined by toroidally revolving the poloidal last-closed-flux-surface.

  triangularity_psi95
    Usually denoted :math:`\delta_{95}`, average of upper and lower triangularity at the :math:`\psi_N=0.95` surface.

  spitzer_resistivity
    Plasma loop collisional resistivity.

  neoclassical_loop_resistivity
    Plasma loop neoclassical resistivity.

  inductive_plasma_current
    Plasma current driven by the central solenoid (i.e. excluding the contribution of the bootstrap current).

  electron_density_peaking_offset
    Scalar offset of the electron density peaking relative to the density peaking scaling.

  ion_density_peaking_offset
    Scalar offset of the ion density peaking relative to the density peaking scaling.

  ion_density_peaking
    Ratio of the peak ion density to the volume-averaged ion density.

  electron_density_peaking
    Ratio of the peak ion density to the volume-averaged electron density.

  temperature_peaking
    Ratio of the peak (electron or ion) temperature to the volume-averaged temperature.

  bootstrap_fraction
    Fraction of the plasma current due to the bootstrap current.

  effective_collisionality
    Estimate of collisionality used for computing the expected density peaking.

  nu_n
    Either the :term:`ion_density_peaking` or the :term:`electron_density_peaking`

  peak_ion_temp
    Peak ion temperature
  
  peak_fuel_ion_density
    Peak fuel ion density (i.e. product of fuel dilution, ion peaking factor and average electron density).

  peak_electron_temp
    Peak electron temperature

  peak_electron_density
    Peak electron density

  current_relaxation_time
    Time constant for the radial current diffusion.

  trapped_particle_fraction
    Global average of the fraction of trapped electrons used in the calculation of global plasma resistivity.

  minimum_core_radiated_fraction
    Minimum fraction of :math:`P_{in}` which should be radiated from the confined region, below which
    we will inject an additional :term:`extrinsic<extrinsic impurity>` core radiator to increase
    the radiated power up to this value.

  radiated_power_scalar
    An enhancement factor :math:`C` to modify the radiated power :math:`P_{rad} = C P_{rad,calculated}`.

  zeff_change_from_core_rad
    Change in :term:`z_effective` due to the injection of a core radiator.

  dilution_change_from_core_rad
    Change in :term:`dilution` due to the injection of a core radiator.

  fuel_ion_density_profile
    A 1D profile of the fuel ion density as a function of :math:`\rho_{pol}`.

  separatrix_triangularity
    Separatrix triangularity (average of upper and lower triangularity).

  plasma_stored_energy
    Thermal energy in the plasma.

  qstar
  q_star
    Analytical approximation of safety factor at :math:`\rho=0.95`.

  loop_voltage
    inductive loop voltage

  tau_e_scaling
    Which :math:`\tau_e` energy confinement scaling should be used. Should match a confinement scaling in `cfspopcon.formulas.energy_confinement::energy_confinement_scalings.yaml`.

  energy_confinement_time
    A characteristic time which gives the rate at which the plasma loses energy. In steady-state, :math:`\tau_e=W_p / P_in`.

  P_in
    Total input power to the plasma. Sum of ohmic, auxillary and alpha power.

  fraction_of_P_SOL_to_divertor
    fraction of the total power going towards the :term:`target`.

  P_LH_thresh
    Power required to cross the L-H transition.

  SOC_LOC_ratio
    Ratio of the energy confinement time from the chosen saturated ohmic confinement (SOC) scaling and the chosen linear ohmic confinement (LOC) scaling.

  P_LI_thresh
    Power required to cross the L-I transition.

  P_ohmic
  P_Ohmic
    Power deposited in the plasma due to resistive ohmic heating.

  major_radius
    The major radius of the geometric magnetic axis.

  minor_radius
    Horizontal minor radius of the plasma :math:`(R_{max,LCFS}-R_{min,LCFS})/2`

  vertical_minor_radius
    Vertical minor radius of the plasma :math:`(Z_{max,LCFS}-Z_{min,LCFS})/2`

  product_of_magnetic_field_and_radius
    Product of the major radius and the (vacuum) magnetic field :math:`B \times R`.

  fusion_reaction
    A `str` indicating which fusion reaction should be used, should match a class name in `cfspopcon.formulas.fusion_reaction.fusion_data`

  heavier_fuel_species_fraction
    Fraction of fuel ions which are the heavier species. i.e. for DT fusion, this is :math:`f_T = n_T/(n_T+n_D)`.

  lengyel_overestimation_factor
    A constant calibration factor applied to the impurity concentration calculated by the Lengyel model such that its value approximately matches the value calculated by higher fidelity modelling such as SOLPS.

  reference_electron_density
    A constant upstream electron density used when evaluating the :math:`L_Z` impurity radiation curve (due to the reasonably weak dependence of :math:`L_Z` on :math:`n_e`, this approximation shouldn't be too harmful).

  reference_ne_tau
    A constant :math:`n_e\tau` (upstream electron density times impurity residence time) used when evaluating the :math:`L_Z` impurity radiation curve.

  edge_impurity_species
    An :class:`~cfspopcon.named_options.AtomicSpecies` indicating which :term:`extrinsic<extrinsic impurity>` edge radiator species should be injected into the confined region to enhance the edge radiated power.

  edge_impurity_enrichment
    Ratio of concentration of the edge radiator in the core to in the edge, :math:`f_e = n_{edge}/n_{core}`.

  edge_impurity_concentration
    Concentration of the edge radiator (impurity density relative to the electron density) in the edge.

  confinement_threshold_scalar
    Scalar value applied to the confinement threshold (:math:`P_{LH}` or :math:`P_{LI}`), used to study the effect of increasing or decreasing the threshold.
  
  Lmode_density_limit_condition
    Condition function for the L-mode density limit (calculated by the separatrix operational space). If $c_{LDL} > 1$, the state is predicted to be unstable.
  
  ideal_MHD_limit_condition
    Condition function for the ideal MHD limit (calculated by the separatrix operational space). If $c_{MHD} > 1$, the state is predicted to be unstable.
  
  LH_transition_condition
    Condition function for the LH limit (calculated by the separatrix operational space). If $c_{LH} > 1$, the state is predicted to be in H-mode.
  
  alpha_t
  alpha_t_turbulence_param
    Turbulence characterization parameter used by the separatrix operational space.
  
  cylindrical_safety_factor
    Analytical approximation of safety factor at :math:`\rho=0.95` (confusingly, still has some shaping corrections despite being called the 'cylindrical' safety factor).

  edge_collisionality
    Collisionality at the separatrix.

  critical_alpha_MHD
    Critical value of :math:`\alpha_{MHD}` used in the separatrix operational space.

  poloidal_sound_larmor_radius
    The sound Larmor radius using the poloidal magnetic field.

  SepOS_density_limit
    Less than 1 if an L-mode is below the density limit, according to the separatrix operational space.

  SepOS_LH_transition
    Less than 1 if in L-mode and greater than 1 if in H-mode, according to the separatrix operational space.

  SepOS_MHD_limit
    Less than 1 if below the ideal MHD limit, according to the separatrix operational space.

  elongation_psi95
    Usually denoted :math:`\kappa_{95}`, the elongation at the :math:`\psi_N=0.95` surface.

  ion_heat_diffusivity
    A heat diffusion constant which gives a heat flux corresponding to an ion temperature gradient.

  temp_scale_length_ratio
    The ratio of the electron and ion temperature scale lengths at the separatrix.

  sustainment_power_in_ion_channel
    The power in the ion channel required to maintain the ion temperature gradient at the separatrix.

  sustainment_power_in_electron_channel
    The power in the electron channel required to maintain the electron temperature at the separatrix.